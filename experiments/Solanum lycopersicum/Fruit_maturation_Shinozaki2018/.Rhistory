Tomato_fruit_Shinozaki2018<-shinozaki_tomato_fruit
View(enrichment)
enrichment<-function(mygenes) {
experiment_id <- Tomato_fruit_Shinozaki2018
# Avoid duplications in user-input genes
mygenes<-unique(mygenes)
# Case insensitive
mygenes<-tolower(mygenes)
# Create a vector that will hold the pvalues of Fisher test per tissue
myvector<-c()
# Loop over the tissue list with expression-specific genes (experiment id)
for (i in 1:length(experiment_id)) {
# Genes detected in the microarray/RNAseq that are not in user-input
nomygenes<-setdiff(geneuniverse,mygenes)
# Generate contingency table
mytable<-rbind(c(length(which(mygenes%in%experiment_id[[i]])),#  genes in mylist & enriched in tissue iN
length(which(mygenes%in%experiment_id[[i]]==FALSE))), #  genes in my list & NOT enriched in tissue iN
c(length(which(nomygenes%in%experiment_id[[i]])), #  genes NOT in my list & enriched in tissue iN
length(which(nomygenes%in%experiment_id[[i]]==FALSE)))) #  genes NOT in my list & NOT enriched in tissue iN
# Add names to the contingency table (traceback)
rownames(mytable)<-c("Mygenes","!Mygenes"); colnames(mytable)<-c("Enriched","!Enriched")
# Append to myvector the Fishers exact test result (pvalue)
myvector<-c(myvector,fisher.test(mytable,alternative = "greater")$p.value) # Alternative = greater because the scope is to detect overepresentation of tissue-specific genes in the user gene list
}
# Adjust p-values for multiple testing
myvector<-p.adjust(myvector,method = "BH")
# Add tissue names to myvector
names(myvector)<-names(experiment_id)
# Return the -log transformed pvalue vector
return(-log(myvector))
}
save.image("~/Dropbox/TOTEM/local_totem/experiments/Tomato_fruit_Shinozaki2018/Tomato_fruit_Shinozaki2018.RData")
rm(shinozaki_tomato_fruit)
save.image("~/Dropbox/TOTEM/local_totem/experiments/Tomato_fruit_Shinozaki2018/Tomato_fruit_Shinozaki2018.RData")
